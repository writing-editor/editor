/* --- 1. THEME & GLOBAL VARIABLES --- */

:root {
  --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  --navigator-width: 320px;
  --right-drawer-width: 40%;
  --editor-pane-shrunk-width: 60%;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --blur-backdrop: blur(5px);
  --color-highlight-bg: rgb(255, 248, 200);

  --color-background: rgb(255, 255, 245);
  --color-surface-light: var(--color-background);
  --color-surface-medium: rgb(248, 248, 225);

  --color-text: #1a1a1a;
  --color-text-muted: #7a7a70;
  --color-text-disabled: #adb5bd;
  --color-heading: var(--color-text);
  --color-border: rgb(245, 245, 225);

  --color-primary: rgb(244, 244, 220);
  --color-primary-hover: var(--color-primary);
  --color-primary-text: #1a1a1a;

  --color-success: #52b788;
  --color-success-bg: #edf7f2;
  --color-danger: #e57373;
  --color-danger-bg: #f9e5e5;

  --color-selection: var(--color-primary);
  --color-hover: var(--color-surface-medium);
  --color-disabled-bg: rgb(244, 244, 225);
  --color-shadow: rgba(0, 0, 0, 0.05);
  --color-overlay-bg: rgba(248, 249, 250, 0.5);
}


body.theme-dark {
  --color-background: #121212;
  --color-surface-light: #131313;
  --color-surface-medium: #2c2c2c;

  --color-text: #e0e0e0;
  --color-text-muted: #888888;
  --color-text-disabled: #444444;
  --color-heading: #f8f9fa;
  --color-border: #333333;

  --color-primary: #3a3a3a;
  --color-primary-hover: var(--color-primary);
  --color-primary-text: #f5f5f5;

  --color-success: #2d6a4f;
  --color-success-bg: #1c2b22;
  --color-danger: #ae2012;
  --color-danger-bg: #3c1b1f;

  --color-selection: var(--color-primary);
  --color-hover: var(--color-surface-medium);
  --color-disabled-bg: #2c2c2c;
  --color-shadow: rgba(0, 0, 0, 0.4);
  --color-overlay-bg: rgba(10, 10, 10, 0.5);
  --color-highlight-bg: rgba(70, 130, 180, 0.3);
}

/* --- 2. GLOBAL & LAYOUT STYLES --- */
body,
html {
  height: 100%;
  margin: 0;
  font-family: var(--font-sans);
  color: var(--color-text);
  background-color: var(--color-background);
  overflow: hidden;
}

#root {
  height: 100vh;
  width: 100vw;
}

#app {
  display: flex;
  height: 100%;
  min-width: 0;
  position: relative;
  overflow: hidden;
}

#navigator-drawer {
  width: var(--navigator-width);
  height: 100%;
  background-color: var(--color-background);
  flex-shrink: 0;
  /* Prevents the navigator from shrinking */
  box-sizing: border-box;
  overflow-y: auto;
  padding: 60px var(--spacing-md) var(--spacing-md);
  position: relative;

  /* The animation is now controlled by margin */
  margin-left: calc(-1 * var(--navigator-width));
  transition: margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* This class on the body will slide the drawer into view */
body.drawer-is-open #navigator-drawer {
  margin-left: 0;
}

#main-container {
  width: 100%;
  min-width: 0;
  overflow: hidden;
  position: relative;
  transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

body.right-drawer-is-open #main-container {
  width: var(--editor-pane-shrunk-width);
}

#editor-wrapper {
  display: flex;
  position: relative;
  height: 100%;
  min-height: 0;
  flex-grow: 1;
}

#editor-pane {
  flex: 1;
  padding: var(--spacing-lg) var(--spacing-lg) 50vh;
  overflow-y: auto;
  box-sizing: border-box;
}


.right-drawer {
  position: fixed;
  top: 0;
  right: 0;
  width: var(--right-drawer-width);
  height: 100%;
  z-index: 1001;
  transform: translateX(100%);
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

.right-drawer.is-visible {
  transform: translateX(0);
}

.notebook-header,
.note-editor-container {
  flex-shrink: 0;
}

#note-blocks-container {
  flex-grow: 1;
  overflow-y: auto;
  min-height: 0;
}

#assistant-drawer,
#search-results-container {
  flex-grow: 1;
  overflow-y: auto;
  min-height: 0;
}

.search-header {
  flex-shrink: 0;
}

.hidden {
  display: none !important;
}

/* --- 3. GLOBAL CONTROL BUTTONS & ICONS (ENHANCED ANIMATIONS VERSION) --- */

/* --- A) Base Button Styles --- */
#navigator-toggle-btn,
.app-control-btn {
  background-color: transparent;
  border: none;
  width: 40px;
  height: 40px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  border-radius: 6px;
  color: var(--color-text);
  transition: transform 0.2s ease-out;
}

/* Position of Navigator Button */
#navigator-toggle-btn {
  position: fixed;
  top: var(--spacing-md);
  left: var(--spacing-md);
  z-index: 1003;
}

#navigator-toggle-btn:hover,
.app-control-btn:hover {
  transform: scale(1.08);
  animation: btn-focus-shake 0.35s ease-in-out;
}

.app-control-btn:active {
  transform: scale(0.92);
}

/* Shake Animation */
@keyframes btn-focus-shake {

  0%,
  100% {
    transform: scale(1.08) translateX(0);
  }

  25% {
    transform: scale(1.08) translateX(-1px);
  }

  50% {
    transform: scale(1.08) translateX(1px);
  }

  75% {
    transform: scale(1.08) translateX(-1px);
  }
}


/* --- B) Button Containers --- */
#app-controls {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 1004;
}

#top-right-controls,
#bottom-right-controls {
  position: absolute;
  pointer-events: all;
  display: flex;
  gap: 8px;
}

#top-right-controls {
  top: var(--spacing-md);
  right: var(--spacing-md);
}

#bottom-right-controls {
  bottom: var(--spacing-md);
  right: var(--spacing-md);
}


/* --- C) Icon-Specific Styles --- */

/* --- ICON 1: Hamburger (Navigator) --- */
.icon-hamburger {
  width: 20px;
  height: 18px;
  position: relative;
}

.icon-hamburger span {
  display: block;
  position: absolute;
  height: 2px;
  width: 100%;
  background: var(--color-text);
  border-radius: 2px;
  left: 0;
  transform: rotate(0deg);
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.25s ease;
}

.icon-hamburger span:nth-child(1) {
  top: 0px;
}

.icon-hamburger span:nth-child(2) {
  top: 8px;
}

.icon-hamburger span:nth-child(3) {
  top: 16px;
}

body.drawer-is-open .icon-hamburger span:nth-child(1) {
  top: 8px;
  transform: rotate(135deg) scale(1.1);
}

body.drawer-is-open .icon-hamburger span:nth-child(2) {
  opacity: 0;
  transform: translateX(-20px) scale(0.5);
}

body.drawer-is-open .icon-hamburger span:nth-child(3) {
  top: 8px;
  transform: rotate(-135deg) scale(1.1);
}


/* --- ICON 2: Pages (Notebook) --- */
.icon-pages {
  width: 18px;
  height: 18px;
  position: relative;
}

.icon-pages span {
  display: block;
  position: absolute;
  height: 2px;
  width: 100%;
  background: var(--color-text);
  border-radius: 2px;
  left: 0;
  transform: rotate(0deg);
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.25s ease;
}

/* Notebook Lines */
.icon-pages span:nth-child(1) {
  top: 3px;
  left: -3px;
  width: 85%;
}

/* "hanging" page */
.icon-pages span:nth-child(2) {
  top: 8px;
}

.icon-pages span:nth-child(3) {
  top: 13px;
}

/* Active Morph (Notebook → X) */
#notebook-toggle-btn.is-active .icon-pages span:nth-child(1) {
  top: 8px;
  transform: rotate(135deg) scale(1.1);
  left: 0;
  /* align back */
  width: 100%;
}

#notebook-toggle-btn.is-active .icon-pages span:nth-child(2) {
  opacity: 0;
  transform: translateX(-20px) scale(0.5);
}

#notebook-toggle-btn.is-active .icon-pages span:nth-child(3) {
  top: 8px;
  transform: rotate(-135deg) scale(1.1);
}


/* --- ICON 3: Spark (AI Assistant) --- */
.icon-spark {
  width: 20px;
  height: 20px;
  position: relative;
}

.icon-spark span {
  display: block;
  position: absolute;
  height: 2px;
  width: 100%;
  background: var(--color-text);
  border-radius: 2px;
  left: 0;
  top: 9px;
  /* Center point */
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.25s ease;
}

.icon-spark span:nth-child(1) {
  transform: rotate(90deg);
}

.icon-spark span:nth-child(2) {
  transform: rotate(45deg);
}

.icon-spark span:nth-child(3) {
  transform: rotate(-45deg);
}

/* Active Morph (Spark → X-like form) */
#assistant-toggle-btn.is-active .icon-spark span:nth-child(1) {
  opacity: 0;
}

#assistant-toggle-btn.is-active .icon-spark span:nth-child(2) {
  transform: rotate(135deg) scale(1.1);
}

#assistant-toggle-btn.is-active .icon-spark span:nth-child(3) {
  transform: rotate(45deg) scale(1.1);
}


.app-back-btn {
  background: none;
  border: none;
  cursor: pointer;
  color: var(--color-text);
  padding: 8px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background-color 0.2s;
}

.app-back-btn:hover {
  background-color: var(--color-surface-medium);
}

.app-back-btn svg {
  width: 24px;
  height: 24px;
  stroke: currentColor;
  stroke-width: 2;
  /* <-- This controls the thickness */
  fill: none;
  stroke-linecap: round;
  stroke-linejoin: round;
}



#status-indicator-container {
  position: fixed;
  bottom: 20px;
  right: 20px;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 8px;
  z-index: 9999;
  pointer-events: none;
}

/* Base style for all indicator bubbles */
.status-indicator-item {
  padding: 8px 15px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 500;
  box-shadow: 0 4px 12px var(--color-shadow);
  animation: slide-in 0.5s forwards ease;

  /* --- THEME AWARE STYLES --- */
  background-color: var(--color-text);
  color: var(--color-background);
}

/* Modifier class for error indicators */
.status-indicator-item.is-error {
  background-color: var(--color-danger);
  color: #fff;
  /* White text provides the best contrast on a red background */
}

@keyframes slide-in {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}


/* --- 5. SCROLLBAR HIDING --- */
#editor-pane::-webkit-scrollbar,
#navigator-drawer::-webkit-scrollbar,
.right-drawer::-webkit-scrollbar,
#note-blocks-container::-webkit-scrollbar {
  display: none;
}

/* This is the standard property for Firefox */
#editor-pane,
#navigator-drawer,
.right-drawer,
#note-blocks-container {
  scrollbar-width: none;
}

/* --- Style for the new main settings icon --- */
#settings-toggle-btn .settings-icon {
  width: 24px;
  height: 24px;
  stroke: currentColor;
  /* Makes the icon theme-aware */
  stroke-width: 1.5;
  fill: none;
  transition: transform 0.3s ease;
}

#settings-toggle-btn:hover .settings-icon {
  transform: rotate(45deg);
  /* Add a nice rotation on hover */
}

/* --- 6. WORD COUNT DISPLAY --- */
#word-count-display {
  position: absolute;
  bottom: 16px;
  left: 50%;
  transform: translateX(-50%);
  padding: 4px 12px;
  border-radius: 12px;
  font-size: 13px;
  font-family: var(--font-sans);
  color: var(--color-text-muted);
  background-color: color-mix(in srgb, var(--color-background) 80%, transparent);
  backdrop-filter: blur(4px);
  border: 1px solid var(--color-border);
  z-index: 10;
  white-space: nowrap;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#word-count-display.is-hidden {
  opacity: 0;
  transform: translate(-50%, 10px);
  pointer-events: none;
}