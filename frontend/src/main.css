/* --- 1. THEME & GLOBAL VARIABLES --- */

:root {
  --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --navigator-width: 320px;
  --right-drawer-width: 40%;
  --editor-pane-shrunk-width: 60%;
  --spacing-md: 16px;
  --spacing-lg: 24px;

  /* Base Surfaces */
  --color-background: #f7faf6;       /* paper-like gray-white w/ green hint */
  --color-surface-light: #ffffff;    /* clean surface (cards, toolbar) */
  --color-surface-medium: #f0f3ef;   /* soft gray block */

  /* Text */
  --color-text: #1c1f1a;             /* near-black with olive undertone */
  --color-text-muted: #5c635b;       /* muted gray */
  --color-text-disabled: #a0a6a0;    /* desaturated gray-green */

  /* Headings / UI chrome */
  --color-heading: #111512;          /* slightly darker for hierarchy */

  /* Borders & Dividers */
  --color-border: #d8ddd7;           /* grayish border */
  --color-divider: rgba(28, 31, 26, 0.08);

  /* Neutral Accents (replacing color coding with tonal hierarchy) */
  --color-primary: #444a42;          /* strong gray, anchor accent */
  --color-primary-hover: #2f332d;    /* deeper neutral */
  --color-primary-text: #ffffff;     /* for buttons/labels */

  --color-success: #6a7268;          /* mid-gray-green */
  --color-success-bg: #ecefed;       /* pale neutral gray-green background */

  --color-danger: #5a4d4d;           /* muted warm gray with red tint */
  --color-danger-bg: #f3eeee;        /* pale gray-red background */

  /* States */
  --color-selection: #e0e4df;        /* soft gray-green highlight */
  --color-hover: rgba(28, 31, 26, 0.04);
  --color-disabled-bg: #f2f4f2;
  --color-shadow: rgba(20, 30, 15, 0.08);
}


body.theme-dark {
  /* Base */
  --color-background: #002b36;       /* deep solarized teal */
  --color-surface-light: #08404f;    /* lighter surface */
  --color-surface-medium: #586e75;   /* muted grayish teal */

  /* Text */
  --color-text: #a1b0b6;             /* main body text */
  --color-text-muted: #839496;       /* secondary/muted text */
  --color-text-disabled: #586e75;    /* disabled text */

  /* Headings / UI chrome */
  --color-heading: #cfd8dc;          /* brighter text for hierarchy */

  /* Borders & Dividers */
  --color-border: rgba(255,255,255,0.1);
  --color-divider: rgba(255,255,255,0.08);

  /* Primary Accent */
  --color-primary: #2175b1;          /* calm blue */
  --color-primary-hover: #1d6fa6;    /* darker hover */
  --color-primary-text: #ffffff;

  /* Success / Danger */
  --color-success: #859900;
  --color-success-bg: #3a4623;
  --color-danger: #dc322f;
  --color-danger-bg: #3c2f2f;

  /* States */
  --color-selection: #1a4b5c;        /* deep cyan highlight */
  --color-hover: rgba(255,255,255,0.05);
  --color-disabled-bg: #083642;
  --color-shadow: rgba(0, 0, 0, 0.5);
}


/* --- 2. GLOBAL & LAYOUT STYLES --- */
body,
html {
  height: 100%;
  margin: 0;
  font-family: var(--font-sans);
  color: var(--color-text);
  background-color: var(--color-background);
  overflow: hidden;
}

#root {
  height: 100vh;
  width: 100vw;
}

#app {
  display: flex;
  height: 100%;
  min-width: 0;
  position: relative;
  overflow: hidden;
}

#main-container {
  width: 100%;
  min-width: 0;
  overflow: hidden;
  position: relative;
  transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

body.right-drawer-is-open #main-container {
  width: var(--editor-pane-shrunk-width);
}

#editor-wrapper {
  display: flex;
  position: relative;
  height: 100%;
  min-height: 0;
  flex-grow: 1;
}

#editor-pane {
  flex: 1;
  padding: var(--spacing-lg);
  overflow-y: auto;
  box-sizing: border-box;
}


.right-drawer {
  position: fixed;
  top: 0;
  right: 0;
  width: var(--right-drawer-width);
  height: 100%;
  z-index: 1001;
  transform: translateX(100%);
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

.right-drawer.is-visible {
  transform: translateX(0);
}

.notebook-header,
.note-editor-container {
  flex-shrink: 0;
}

#note-blocks-container {
  flex-grow: 1;
  overflow-y: auto;
  min-height: 0;
}

#assistant-drawer,
#search-results-container {
  flex-grow: 1;
  overflow-y: auto;
  min-height: 0;
}

.search-header {
  flex-shrink: 0;
}

.hidden {
  display: none !important;
}

/* --- 3. GLOBAL CONTROL BUTTONS & ICONS (ENHANCED ANIMATIONS VERSION) --- */

/* --- A) Base Button Styles --- */
#navigator-toggle-btn,
.app-control-btn {
  background-color: transparent;
  border: none;
  width: 40px;
  height: 40px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  border-radius: 6px;
  color: var(--color-text);
  transition: transform 0.2s ease-out;
}

/* Position of Navigator Button */
#navigator-toggle-btn {
  position: fixed;
  top: var(--spacing-md);
  left: var(--spacing-md);
  z-index: 1003;
}

#navigator-toggle-btn:hover,
.app-control-btn:hover {
  transform: scale(1.08);
  animation: btn-focus-shake 0.35s ease-in-out;
}

.app-control-btn:active {
  transform: scale(0.92);
}

/* Shake Animation */
@keyframes btn-focus-shake {

  0%,
  100% {
    transform: scale(1.08) translateX(0);
  }

  25% {
    transform: scale(1.08) translateX(-1px);
  }

  50% {
    transform: scale(1.08) translateX(1px);
  }

  75% {
    transform: scale(1.08) translateX(-1px);
  }
}


/* --- B) Button Containers --- */
#app-controls {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 1004;
}

#top-right-controls,
#bottom-right-controls {
  position: absolute;
  pointer-events: all;
  display: flex;
  gap: 8px;
}

#top-right-controls {
  top: var(--spacing-md);
  right: var(--spacing-md);
}

#bottom-right-controls {
  bottom: var(--spacing-md);
  right: var(--spacing-md);
}


/* --- C) Icon-Specific Styles --- */

/* --- ICON 1: Hamburger (Navigator) --- */
.icon-hamburger {
  width: 20px;
  height: 18px;
  position: relative;
}

.icon-hamburger span {
  display: block;
  position: absolute;
  height: 2px;
  width: 100%;
  background: var(--color-text);
  border-radius: 2px;
  left: 0;
  transform: rotate(0deg);
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.25s ease;
}

.icon-hamburger span:nth-child(1) {
  top: 0px;
}

.icon-hamburger span:nth-child(2) {
  top: 8px;
}

.icon-hamburger span:nth-child(3) {
  top: 16px;
}

body.drawer-is-open .icon-hamburger span:nth-child(1) {
  top: 8px;
  transform: rotate(135deg) scale(1.1);
}

body.drawer-is-open .icon-hamburger span:nth-child(2) {
  opacity: 0;
  transform: translateX(-20px) scale(0.5);
}

body.drawer-is-open .icon-hamburger span:nth-child(3) {
  top: 8px;
  transform: rotate(-135deg) scale(1.1);
}


/* --- ICON 2: Pages (Notebook) --- */
.icon-pages {
  width: 18px;
  height: 18px;
  position: relative;
}

.icon-pages span {
  display: block;
  position: absolute;
  height: 2px;
  width: 100%;
  background: var(--color-text);
  border-radius: 2px;
  left: 0;
  transform: rotate(0deg);
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.25s ease;
}

/* Notebook Lines */
.icon-pages span:nth-child(1) {
  top: 3px;
  left: -3px;
  width: 85%;
}

/* "hanging" page */
.icon-pages span:nth-child(2) {
  top: 8px;
}

.icon-pages span:nth-child(3) {
  top: 13px;
}

/* Active Morph (Notebook → X) */
#notebook-toggle-btn.is-active .icon-pages span:nth-child(1) {
  top: 8px;
  transform: rotate(135deg) scale(1.1);
  left: 0;
  /* align back */
  width: 100%;
}

#notebook-toggle-btn.is-active .icon-pages span:nth-child(2) {
  opacity: 0;
  transform: translateX(-20px) scale(0.5);
}

#notebook-toggle-btn.is-active .icon-pages span:nth-child(3) {
  top: 8px;
  transform: rotate(-135deg) scale(1.1);
}


/* --- ICON 3: Spark (AI Assistant) --- */
.icon-spark {
  width: 20px;
  height: 20px;
  position: relative;
}

.icon-spark span {
  display: block;
  position: absolute;
  height: 2px;
  width: 100%;
  background: var(--color-text);
  border-radius: 2px;
  left: 0;
  top: 9px;
  /* Center point */
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.25s ease;
}

.icon-spark span:nth-child(1) {
  transform: rotate(90deg);
}

.icon-spark span:nth-child(2) {
  transform: rotate(45deg);
}

.icon-spark span:nth-child(3) {
  transform: rotate(-45deg);
}

/* Active Morph (Spark → X-like form) */
#assistant-toggle-btn.is-active .icon-spark span:nth-child(1) {
  opacity: 0;
}

#assistant-toggle-btn.is-active .icon-spark span:nth-child(2) {
  transform: rotate(135deg) scale(1.1);
}

#assistant-toggle-btn.is-active .icon-spark span:nth-child(3) {
  transform: rotate(45deg) scale(1.1);
}




#status-indicator-container {
  position: fixed;
  bottom: 20px;
  right: 20px;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 8px;
  z-index: 9999;
  pointer-events: none;
}

/* Base style for all indicator bubbles */
.status-indicator-item {
  padding: 8px 15px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 500;
  box-shadow: 0 4px 12px var(--color-shadow);
  animation: slide-in 0.5s forwards ease;

  /* --- THEME AWARE STYLES --- */
  background-color: var(--color-text);
  color: var(--color-background);
}

/* Modifier class for error indicators */
.status-indicator-item.is-error {
  background-color: var(--color-danger);
  color: #fff;
  /* White text provides the best contrast on a red background */
}

@keyframes slide-in {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}


/* --- 5. SCROLLBAR HIDING --- */
#editor-pane::-webkit-scrollbar,
#navigator-drawer::-webkit-scrollbar,
.right-drawer::-webkit-scrollbar,
#note-blocks-container::-webkit-scrollbar {
  display: none;
}

/* This is the standard property for Firefox */
#editor-pane,
#navigator-drawer,
.right-drawer,
#note-blocks-container {
  scrollbar-width: none;
}

/* --- Style for the new main settings icon --- */
#settings-toggle-btn .settings-icon {
  width: 24px;
  height: 24px;
  stroke: currentColor;
  /* Makes the icon theme-aware */
  stroke-width: 1.5;
  fill: none;
  transition: transform 0.3s ease;
}

#settings-toggle-btn:hover .settings-icon {
  transform: rotate(45deg);
  /* Add a nice rotation on hover */
}

/* --- 6. WORD COUNT DISPLAY --- */
#word-count-display {
  position: absolute;
  bottom: 16px;
  left: 50%;
  transform: translateX(-50%);
  padding: 4px 12px;
  border-radius: 12px;
  font-size: 13px;
  font-family: var(--font-sans);
  color: var(--color-text-muted);
  background-color: color-mix(in srgb, var(--color-background) 80%, transparent);
  backdrop-filter: blur(4px);
  border: 1px solid var(--color-border);
  z-index: 10;
  white-space: nowrap;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#word-count-display.is-hidden {
  opacity: 0;
  transform: translate(-50%, 10px);
  pointer-events: none;
}