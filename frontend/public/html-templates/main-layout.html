<div id="app">
    <button id="navigator-toggle-btn">
        <div class="icon-hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </button>
    <div id="navigator-drawer"></div>

    <div id="main-container">
        <div id="editor-pane"></div>
        <div id="word-count-display"></div>
    </div>

    <div id="assistant-drawer" class="right-drawer"></div>
    <div id="notebook-drawer" class="right-drawer"></div>
    <div id="search-drawer" class="right-drawer"></div>
    <div id="prompts-drawer" class="right-drawer"></div>

    <div id="app-controls">
        <div id="top-right-controls">
            <!-- REVISED: Assistant toggle uses the new, consistent structure -->
            <button id="assistant-toggle-btn" class="app-control-btn" title="Toggle AI Assistant">
                <div class="icon-spark">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            <!-- REVISED: Notebook toggle uses the new, consistent structure -->
            <button id="notebook-toggle-btn" class="app-control-btn" title="Toggle Notebook">
                <div class="icon-pages">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
        </div>
        <div id="bottom-right-controls">

            <button id="settings-toggle-btn" class="app-control-btn" title="Settings">
                <svg class="settings-icon" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path
                        d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                    </path>
                </svg>
            </button>


        </div>
    </div>
    <!-- RENAMED: from command-palette-container to ai-studio-container -->
    <div id="ai-studio-container" class="hidden">
        <div id="ai-studio">
            <!-- NEW: A simple, clean header -->
            <div id="ai-studio-header">
                <h4>AI Workbench</h4>
            </div>
            <!-- The form now correctly wraps only the content area -->
            <form id="cp-form">
                <div id="cp-content-area">
                    <div class="cp-tab-panel active" data-panel="workbench"></div>
                </div>
                <!-- This hidden submit button is good practice for form accessibility -->
                <button type="submit" style="display: none;"></button>
            </form>
        </div>
    </div>
    <div id="settings-palette-container" class="hidden"></div>
    <div id="modal-input-container" class="hidden">
        <div id="modal-input-box">
            <h3 id="modal-title">Create New</h3>
            <input type="text" id="modal-input" placeholder="Enter title...">
        </div>
    </div>
    <div id="confirmation-modal-container" class="hidden">
        <div id="confirmation-modal-box">
            <h3 id="confirmation-title">Are you sure?</h3>
            <p id="confirmation-message">This action cannot be undone.</p>
            <div id="confirmation-actions">
                <button id="confirm-btn-cancel">Cancel</button>
                <button id="confirm-btn-confirm">Confirm</button>
            </div>
        </div>
    </div>
    <div id="confirmation-modal-container" class="hidden">...</div>
    <div id="data-manager-modal-container" class="hidden"></div>
    <div id="merge-conflict-modal-container" class="hidden">
        <div id="merge-conflict-box">
            <h3 id="merge-conflict-title">Resolve Sync Conflict</h3>
            <p id="merge-conflict-message"></p>
            <div id="merge-conflict-content">
                <div class="conflict-pane">
                    <h4>Your Local Version</h4>
                    <!-- REVISED: Changed from <pre> to <div> to support HTML diff -->
                    <div class="conflict-text-display" id="conflict-local-text"></div>
                </div>
                <div class="conflict-pane">
                    <h4>Cloud Version</h4>
                    <!-- REVISED: Changed from <pre> to <div> to support HTML diff -->
                    <div class="conflict-text-display" id="conflict-remote-text"></div>
                </div>
            </div>
            <div id="merge-conflict-actions">
                <!-- REVISED: Button order is swapped for better UX -->
                 <button id="conflict-btn-keep-local">Keep My Version</button>
                <button id="conflict-btn-use-remote">Use Cloud Version</button>
            </div>
        </div>
    </div>
    <div id="status-indicator-container"></div>
    <div id="connectivity-status-container"></div>
</div>
<input type="file" id="import-file-input" style="display: none;" accept=".json,application/json" />